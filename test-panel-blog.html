<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Panel Blog - Espacio Shanti</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
      }
      .button {
        background: #007bff;
        color: white;
        padding: 15px 30px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin: 10px;
        font-size: 16px;
      }
      .button:hover {
        background: #0056b3;
      }
      .button.clear {
        background: #dc3545;
      }
      .button.clear:hover {
        background: #c82333;
      }
      .output {
        background: #f8f9fa;
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 5px;
        margin: 10px 0;
        min-height: 100px;
      }
      .success {
        color: green;
      }
      .info {
        color: blue;
      }
      .warning {
        color: orange;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ§ª Test Panel de Blog</h1>

      <div class="output">
        <h3>ğŸ“ Test de CreaciÃ³n de Entradas</h3>
        <p>
          Esta pÃ¡gina te permite probar la creaciÃ³n de entradas directamente,
          sin usar el panel de terapeutas.
        </p>
      </div>

      <div>
        <button class="button" onclick="createTestEntryNew()">
          âœ¨ Crear Entrada con Nuevo Formato
        </button>
        <button class="button" onclick="viewEntries()">ğŸ‘€ Ver Entradas</button>
        <button class="button clear" onclick="clearEntries()">
          ğŸ—‘ï¸ Limpiar Entradas
        </button>
      </div>

      <div id="output" class="output">
        Haz clic en "Crear Entrada con Nuevo Formato" para probar...
      </div>
    </div>

    <script>
      function log(message, type = "info") {
        const output = document.getElementById("output");
        const timestamp = new Date().toLocaleTimeString();
        const colorClass =
          type === "success"
            ? "success"
            : type === "info"
            ? "info"
            : type === "warning"
            ? "warning"
            : "";
        output.innerHTML += `<div class="${colorClass}">[${timestamp}] ${message}</div>`;
      }

      function clearOutput() {
        document.getElementById("output").innerHTML = "";
      }

      function createTestEntryNew() {
        clearOutput();
        log("âœ¨ Creando entrada con el NUEVO formato...", "info");

        const currentDate = new Date();

        // Simular exactamente lo que hace el nuevo cÃ³digo del panel
        const testEntry = {
          title: "Test Nueva Entrada - " + currentDate.toLocaleTimeString(),
          category: "terapias",
          emoji: "ğŸ’†â€â™€ï¸", // Emoji vÃ¡lido
          summary:
            "Esta es una entrada de prueba creada con el nuevo formato que incluye tanto createdAt como date.",
          content:
            'Esta entrada se creÃ³ usando el formato corregido que incluye tanto el campo createdAt (en formato ISO) como el campo date (en formato espaÃ±ol). Esto deberÃ­a resolver los problemas de "Fecha no disponible" que estÃ¡bamos viendo antes. El contenido tiene mÃ¡s de 200 caracteres para cumplir con la validaciÃ³n.',
          tips: ["Tip de prueba 1", "Tip de prueba 2"],
          author: "test.user@espacioshanti.com",
          createdAt: currentDate.toISOString(), // âœ… Campo createdAt en formato ISO
          date: currentDate.toLocaleDateString("es-ES", {
            // âœ… Campo date en espaÃ±ol
            year: "numeric",
            month: "long",
            day: "numeric",
          }),
          id: "test-new-format-" + Date.now(),
        };

        try {
          // Obtener entradas existentes
          let entries = JSON.parse(localStorage.getItem("blogEntries") || "[]");

          // Agregar la nueva entrada al principio
          entries.unshift(testEntry);

          // Guardar
          localStorage.setItem("blogEntries", JSON.stringify(entries));

          log("ğŸ‰ Â¡Entrada creada exitosamente!", "success");
          log("ğŸ“Š Datos de la nueva entrada:", "info");
          log(`  â€¢ TÃ­tulo: "${testEntry.title}"`, "info");
          log(`  â€¢ Emoji: ${testEntry.emoji}`, "info");
          log(`  â€¢ createdAt: ${testEntry.createdAt}`, "info");
          log(`  â€¢ date: ${testEntry.date}`, "info");
          log(`  â€¢ Autor: ${testEntry.author}`, "info");
          log(`  â€¢ CategorÃ­a: ${testEntry.category}`, "info");

          log("", "info");
          log("âœ… Esta entrada deberÃ­a mostrar correctamente:", "success");
          log('  â€¢ Fecha: "' + testEntry.date + '"', "success");
          log("  â€¢ Emoji: " + testEntry.emoji, "success");
          log("  â€¢ Autor: extraÃ­do del email", "success");

          log("", "info");
          log(
            "ğŸ”„ Ve a index.html para verificar que se muestre correctamente",
            "info"
          );
        } catch (error) {
          log(`âŒ Error al crear entrada: ${error.message}`, "error");
        }
      }

      function viewEntries() {
        clearOutput();
        log("ğŸ‘€ Visualizando entradas actuales...", "info");

        try {
          const entries = JSON.parse(
            localStorage.getItem("blogEntries") || "[]"
          );

          if (entries.length === 0) {
            log("âŒ No hay entradas en localStorage", "warning");
          } else {
            log(`ğŸ“Š Se encontraron ${entries.length} entradas:`, "success");

            entries.forEach((entry, index) => {
              log(`\nğŸ“„ Entrada ${index + 1}:`, "info");
              log(`  â€¢ TÃ­tulo: "${entry.title || "SIN TÃTULO"}"`, "info");
              log(
                `  â€¢ Emoji: "${entry.emoji || "SIN EMOJI"}"`,
                entry.emoji && entry.emoji !== "undefined"
                  ? "success"
                  : "warning"
              );
              log(
                `  â€¢ createdAt: "${entry.createdAt || "NO DEFINIDO"}"`,
                entry.createdAt ? "success" : "warning"
              );
              log(
                `  â€¢ date: "${entry.date || "NO DEFINIDO"}"`,
                entry.date ? "success" : "warning"
              );
              log(
                `  â€¢ Autor: "${entry.author || "SIN AUTOR"}"`,
                entry.author && entry.author !== "undefined"
                  ? "success"
                  : "warning"
              );
            });
          }
        } catch (error) {
          log(`âŒ Error al ver entradas: ${error.message}`, "error");
        }
      }

      function clearEntries() {
        if (
          confirm("Â¿EstÃ¡s seguro de que quieres eliminar todas las entradas?")
        ) {
          localStorage.removeItem("blogEntries");
          clearOutput();
          log("ğŸ—‘ï¸ Todas las entradas han sido eliminadas", "warning");
        }
      }

      // Initialize
      document.addEventListener("DOMContentLoaded", function () {
        log("ğŸš€ Test panel cargado", "success");
      });
    </script>
  </body>
</html>
